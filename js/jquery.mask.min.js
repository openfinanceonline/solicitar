!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(window.jQuery||window.Zepto)}((function(t){var e=function(e,a,n){var r,o,s=this;e=t(e),a="function"==typeof a?a(e.val(),void 0,e,n):a;var i={getCaret:function(){try{var t,a=0,n=e.get(0),r=document.selection,o=n.selectionStart;return r&&!~navigator.appVersion.indexOf("MSIE 10")?((t=r.createRange()).moveStart("character",e.is("input")?-e.val().length:-e.text().length),a=t.text.length):(o||"0"===o)&&(a=o),a}catch(t){}},setCaret:function(t){try{if(e.is(":focus")){var a,n=e.get(0);n.setSelectionRange?n.setSelectionRange(t,t):n.createTextRange&&((a=n.createTextRange()).collapse(!0),a.moveEnd("character",t),a.moveStart("character",t),a.select())}}catch(t){}},events:function(){e.on("keydown.mask",(function(){r=i.val()})).on("keyup.mask",i.behaviour).on("paste.mask drop.mask",(function(){setTimeout((function(){e.keydown().keyup()}),100)})).on("change.mask",(function(){e.data("changed",!0)})).on("blur.mask",(function(){r===e.val()||e.data("changed")||e.trigger("change"),e.data("changed",!1)})).on("focusout.mask",(function(){n.clearIfNotMatch&&!o.test(i.val())&&i.val("")}))},getRegexMask:function(){for(var t,e,n,r,o=[],i=0;i<a.length;i++)(t=s.translation[a[i]])?(e=t.pattern.toString().replace(/.{1}$|^.{1}/g,""),n=t.optional,(t=t.recursive)?(o.push(a[i]),r={digit:a[i],pattern:e}):o.push(n||t?e+"?":e)):o.push(a[i].replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));return o=o.join(""),r&&(o=o.replace(new RegExp("("+r.digit+"(.*"+r.digit+")?)"),"($1)?").replace(new RegExp(r.digit,"g"),r.pattern)),new RegExp(o)},destroyEvents:function(){e.off("keydown keyup paste drop change blur focusout DOMNodeInserted ".split(" ").join(".mask ")).removeData("changeCalled")},val:function(t){var a=e.is("input");return 0<arguments.length?a?e.val(t):e.text(t):a?e.val():e.text()},getMCharsBeforeCount:function(t,e){for(var n=0,r=0,o=a.length;r<o&&r<t;r++)s.translation[a.charAt(r)]||(t=e?t+1:t,n++);return n},caretPos:function(t,e,n,r){return s.translation[a.charAt(Math.min(t-1,a.length-1))]?Math.min(t+n-e-r,n):i.caretPos(t+1,e,n,r)},behaviour:function(e){var a=(e=e||window.event).keyCode||e.which;if(-1===t.inArray(a,s.byPassKeys)){var n=i.getCaret(),r=i.val(),o=r.length,c=n<o,l=i.getMasked(),u=l.length,h=i.getMCharsBeforeCount(u-1)-i.getMCharsBeforeCount(o-1);return l!==r&&i.val(l),!c||65===a&&e.ctrlKey||(8!==a&&46!==a&&(n=i.caretPos(n,o,u,h)),i.setCaret(n)),i.callbacks(e)}},getMasked:function(t){var e,r,o=[],c=i.val(),l=0,u=a.length,h=0,f=c.length,g=1,d="push",v=-1;for(n.reverse?(d="unshift",g=-1,e=0,l=u-1,h=f-1,r=function(){return-1<l&&-1<h}):(e=u-1,r=function(){return l<u&&h<f});r();){var m=a.charAt(l),p=c.charAt(h),k=s.translation[m];k?(p.match(k.pattern)?(o[d](p),k.recursive&&(-1===v?v=l:l===e&&(l=v-g),e===v&&(l-=g)),l+=g):k.optional&&(l+=g,h-=g),h+=g):(t||o[d](m),p===m&&(h+=g),l+=g)}return t=a.charAt(e),u!==f+1||s.translation[t]||o.push(t),o.join("")},callbacks:function(t){var o=i.val(),s=o!==r;!0===s&&"function"==typeof n.onChange&&n.onChange(o,t,e,n),!0===s&&"function"==typeof n.onKeyPress&&n.onKeyPress(o,t,e,n),"function"==typeof n.onComplete&&o.length===a.length&&n.onComplete(o,t,e,n)}};s.mask=a,s.options=n,s.remove=function(){var t;return i.destroyEvents(),i.val(s.getCleanVal()).removeAttr("maxlength"),t=i.getCaret(),i.setCaret(t-i.getMCharsBeforeCount(t)),e},s.getCleanVal=function(){return i.getMasked(!0)},s.init=function(){n=n||{},s.byPassKeys=[9,16,17,18,36,37,38,39,40,91],s.translation={0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}},s.translation=t.extend({},s.translation,n.translation),s=t.extend(!0,{},s,n),o=i.getRegexMask(),!1!==n.maxlength&&e.attr("maxlength",a.length),n.placeholder&&e.attr("placeholder",n.placeholder),e.attr("autocomplete","off"),i.destroyEvents(),i.events();var r=i.getCaret();i.val(i.getMasked()),i.setCaret(r+i.getMCharsBeforeCount(r,!0))}()},a={},n=function(){var e=t(this),a={};e.attr("data-mask-reverse")&&(a.reverse=!0),"false"===e.attr("data-mask-maxlength")&&(a.maxlength=!1),e.attr("data-mask-clearifnotmatch")&&(a.clearIfNotMatch=!0),e.mask(e.attr("data-mask"),a)};t.fn.mask=function(n,r){var o=this.selector,s=function(){var a=t(this).data("mask"),o=JSON.stringify;if("object"!=typeof a||o(a.options)!==o(r)||a.mask!==n)return t(this).data("mask",new e(this,n,r))};this.each(s),o&&!a[o]&&(a[o]=!0,setTimeout((function(){t(document).on("DOMNodeInserted.mask",o,s)}),500))},t.fn.unmask=function(){try{return this.each((function(){t(this).data("mask").remove().removeData("mask")}))}catch(t){}},t.fn.cleanVal=function(){return this.data("mask").getCleanVal()},t("*[data-mask]").each(n),t(document).on("DOMNodeInserted.mask","*[data-mask]",n)}));!function($){"use strict";function e(e,t){var n="";return e.indexOf("-")>-1&&(e=e.replace("-",""),n="-"),e.indexOf(t.prefix)>-1&&(e=e.replace(t.prefix,"")),e.indexOf(t.suffix)>-1&&(e=e.replace(t.suffix,"")),n+t.prefix+e+t.suffix}function t(e,t){return t.allowEmpty&&""===e?"":t.reverse?a(e,t):n(e,t)}function n(t,n){var a,i,o,l=t.indexOf("-")>-1&&n.allowNegative?"-":"",s=t.replace(/[^0-9]/g,"");return a=r(s.slice(0,s.length-n.precision),l,n),n.precision>0&&(i=s.slice(s.length-n.precision),o=new Array(n.precision+1-i.length).join(0),a+=n.decimal+o+i),e(a,n)}function a(t,n){var a,i=t.indexOf("-")>-1&&n.allowNegative?"-":"",o=t.replace(n.prefix,"").replace(n.suffix,""),l=o.split(n.decimal)[0],s="";if(""===l&&(l="0"),a=r(l,i,n),n.precision>0){var c=o.split(n.decimal);c.length>1&&(s=c[1]),a+=n.decimal+s;var u=Number.parseFloat(l+"."+s).toFixed(n.precision).toString().split(n.decimal)[1];a=a.split(n.decimal)[0]+"."+u}return e(a,n)}function r(e,t,n){return e=e.replace(/^0*/g,""),""===(e=e.replace(/\B(?=(\d{3})+(?!\d))/g,n.thousands))&&(e="0"),t+e}$.browser||($.browser={},$.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),$.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),$.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),$.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()),$.browser.device=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()));var i={prefix:"",suffix:"",affixesStay:!0,thousands:",",decimal:".",precision:2,allowZero:!1,allowNegative:!1,doubleClickSelection:!0,allowEmpty:!1,bringCaretAtEndOnFocus:!0},o={destroy:function(){return $(this).unbind(".maskMoney"),$.browser.msie&&(this.onpaste=null),this},applyMask:function(e){return t(e,$(this).data("settings"))},mask:function(e){return this.each(function(){var t=$(this);return"number"==typeof e&&t.val(e),t.trigger("mask")})},unmasked:function(){return this.map(function(){var e,t=$(this).val()||"0",n=-1!==t.indexOf("-");return $(t.split(/\D/).reverse()).each(function(t,n){if(n)return e=n,!1}),t=t.replace(/\D/g,""),t=t.replace(new RegExp(e+"$"),"."+e),n&&(t="-"+t),parseFloat(t)})},unmaskedWithOptions:function(){return this.map(function(){var e=$(this).val()||"0",t=$(this).data("settings")||i,n=new RegExp(t.thousandsForUnmasked||t.thousands,"g");return e=e.replace(n,""),parseFloat(e)})},init:function(n){return n=$.extend($.extend({},i),n),this.each(function(){function a(){var e,t,n,a,r,i=x.get(0),o=0,l=0;return"number"==typeof i.selectionStart&&"number"==typeof i.selectionEnd?(o=i.selectionStart,l=i.selectionEnd):(t=document.selection.createRange())&&t.parentElement()===i&&(a=i.value.length,e=i.value.replace(/\r\n/g,"\n"),(n=i.createTextRange()).moveToBookmark(t.getBookmark()),(r=i.createTextRange()).collapse(!1),n.compareEndPoints("StartToEnd",r)>-1?o=l=a:(o=-n.moveStart("character",-a),o+=e.slice(0,o).split("\n").length-1,n.compareEndPoints("EndToEnd",r)>-1?l=a:(l=-n.moveEnd("character",-a),l+=e.slice(0,l).split("\n").length-1))),{start:o,end:l}}function r(){var e=!(x.val().length>=x.attr("maxlength")&&x.attr("maxlength")>=0),t=a(),n=t.start,r=t.end,i=!(t.start===t.end||!x.val().substring(n,r).match(/\d/)),o="0"===x.val().substring(0,1);return e||i||o}function i(e){w.formatOnBlur||x.each(function(t,n){if(n.setSelectionRange)n.focus(),n.setSelectionRange(e,e);else if(n.createTextRange){var a=n.createTextRange();a.collapse(!0),a.moveEnd("character",e),a.moveStart("character",e),a.select()}})}function o(e){var n,a=x.val().length;x.val(t(x.val(),w)),n=x.val().length,w.reverse||(e-=a-n),i(e)}function l(){var e=x.val();if(!w.allowEmpty||""!==e){var n=e.indexOf(w.decimal);if(w.precision>0)if(n<0)e+=w.decimal+new Array(w.precision+1).join(0);else{var a=e.slice(0,n),r=e.slice(n+1);e=a+w.decimal+r+new Array(w.precision+1-r.length).join(0)}else n>0&&(e=e.slice(0,n));x.val(t(e,w))}}function s(){var e=x.val();return w.allowNegative?""!==e&&"-"===e.charAt(0)?e.replace("-",""):"-"+e:e}function c(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function u(e){var t=(e=e||window.event).which||e.charCode||e.keyCode,n=w.decimal.charCodeAt(0);return void 0!==t&&(!(t<48||t>57)||t===n&&w.reverse?!!r()&&((t!==n||!d())&&(!!w.formatOnBlur||(c(e),p(e),!1))):g(t,e))}function d(){return!v()&&f()}function v(){var e=x.val().length,t=a();return 0===t.start&&t.end===e}function f(){return x.val().indexOf(w.decimal)>-1}function p(e){var t,n,r,i,l=(e=e||window.event).which||e.charCode||e.keyCode,s="";l>=48&&l<=57&&(s=String.fromCharCode(l)),n=(t=a()).start,r=t.end,i=x.val(),x.val(i.substring(0,n)+s+i.substring(r,i.length)),o(n+1)}function g(e,t){return 45===e?(x.val(s()),!1):43===e?(x.val(x.val().replace("-","")),!1):13===e||9===e||(!(!$.browser.mozilla||37!==e&&39!==e||0!==t.charCode)||(c(t),!0))}function m(){setTimeout(function(){l()},0)}function h(){return(parseFloat("0")/Math.pow(10,w.precision)).toFixed(w.precision).replace(new RegExp("\\.","g"),w.decimal)}var w,b,x=$(this);w=$.extend({},n),w=$.extend(w,x.data()),x.data("settings",w),$.browser.device&&x.attr("type","tel"),x.unbind(".maskMoney"),x.bind("keypress.maskMoney",u),x.bind("keydown.maskMoney",function(e){var t,n,r,i,l,s=(e=e||window.event).which||e.charCode||e.keyCode;return void 0!==s&&(t=a(),n=t.start,r=t.end,8!==s&&46!==s&&63272!==s||(c(e),i=x.val(),n===r&&(8===s?""===w.suffix?n-=1:(l=i.split("").reverse().join("").search(/\d/),r=1+(n=i.length-l-1)):r+=1),x.val(i.substring(0,n)+i.substring(r,i.length)),o(n),!1))}),x.bind("blur.maskMoney",function(t){if($.browser.msie&&u(t),w.formatOnBlur&&x.val()!==b&&p(t),""===x.val()&&w.allowEmpty)x.val("");else if(""===x.val()||x.val()===e(h(),w))w.allowZero?w.affixesStay?x.val(e(h(),w)):x.val(h()):x.val("");else if(!w.affixesStay){var n=x.val().replace(w.prefix,"").replace(w.suffix,"");x.val(n)}x.val()!==b&&x.change()}),x.bind("focus.maskMoney",function(){b=x.val(),l();var e,t=x.get(0);w.selectAllOnFocus?t.select():t.createTextRange&&w.bringCaretAtEndOnFocus&&((e=t.createTextRange()).collapse(!1),e.select())}),x.bind("click.maskMoney",function(){var e,t=x.get(0);w.selectAllOnFocus||(t.setSelectionRange&&w.bringCaretAtEndOnFocus?(e=x.val().length,t.setSelectionRange(e,e)):x.val(x.val()))}),x.bind("dblclick.maskMoney",function(){var e,t,n=x.get(0);n.setSelectionRange&&w.bringCaretAtEndOnFocus?(t=x.val().length,e=w.doubleClickSelection?0:t,n.setSelectionRange(e,t)):x.val(x.val())}),x.bind("cut.maskMoney",m),x.bind("paste.maskMoney",m),x.bind("mask.maskMoney",l)})}};$.fn.maskMoney=function(e){return o[e]?o[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.maskMoney"):o.init.apply(this,arguments)}}(window.jQuery||window.Zepto);
